# Инструкция по установке и запуску Telegram-бота для аналитики данных

## Описание
Этот Telegram-бот предназначен для сбора и анализа данных (статистика продаж, активность пользователей) и генерации отчетов. Бот работает с базой данных SQLite и может создавать графики и CSV-файлы.

## Требования
- Python 3.8 или 3.9 (НЕ 3.11 или 3.12, так как с этими версиями могут возникнуть проблемы с зависимостями)
- Доступ к Интернету
- Telegram-аккаунт

## Получение токена для бота
Перед установкой и запуском бота вам необходимо получить API-токен. Для этого:

1. Откройте Telegram и найдите бота @BotFather
2. Отправьте ему команду `/newbot`
3. Следуйте инструкциям BotFather: укажите имя бота и его username (должен заканчиваться на "bot")
4. После создания бота BotFather пришлет вам токен API - длинную строку вида `123456789:ABCDefGhIJKlmNoPQRsTUVwxyZ`
5. Сохраните этот токен - он понадобится при настройке бота

## Установка и запуск на Windows

### Шаг 1: Установка Python
1. Скачайте Python 3.9 с официального сайта: https://www.python.org/downloads/release/python-3913/
   - Прокрутите вниз и выберите "Windows installer (64-bit)" или "Windows installer (32-bit)" в зависимости от вашей системы
2. Запустите загруженный файл
3. **ВАЖНО**: Установите отметку "Add Python 3.9 to PATH" перед установкой
4. Нажмите "Install Now"

### Шаг 2: Скачивание и подготовка файлов бота
1. Создайте на компьютере папку для бота, например, `C:\TelegramBot`
2. Скопируйте файл бота `main.py` в эту папку

### Шаг 3: Открытие командной строки
1. Нажмите на клавиатуре клавиши `Win + R`
2. Введите `cmd` и нажмите Enter
3. В открывшейся командной строке перейдите в созданную папку с ботом:
```
cd C:\TelegramBot
```

### Шаг 4: Создание виртуального окружения и установка зависимостей
1. Создайте виртуальное окружение, введя в командной строке:
```
python -m venv venv
```

2. Активируйте виртуальное окружение:
```
venv\Scripts\activate
```

3. Установите необходимые библиотеки:
```
pip install aiogram==3.0.0 pandas matplotlib
```

### Шаг 5: Изменение токена в файле
1. Откройте файл `main.py` любым текстовым редактором (например, Notepad)
2. Найдите строку: `API_TOKEN = 'ВАШ_ТОКЕН_API'`
3. Замените 'ВАШ_ТОКЕН_API' на токен, полученный от BotFather (не удаляя кавычки)
4. Сохраните файл

### Шаг 6: Запуск бота
1. В командной строке (с активированным виртуальным окружением) введите:
```
python main.py
```
2. Если все установлено правильно, вы увидите сообщение о запуске бота
3. Теперь можете открыть Telegram и начать диалог с вашим ботом

### Остановка бота
Чтобы остановить работу бота, в командной строке нажмите сочетание клавиш `Ctrl+C`

## Установка и запуск на Linux

### Шаг 1: Установка Python и необходимых инструментов
Откройте терминал и выполните следующие команды:

```
sudo apt update
sudo apt install python3.9 python3.9-venv python3-pip git
```

### Шаг 2: Создание папки для бота и загрузка файлов
```
mkdir ~/telegrambot
cd ~/telegrambot
```

Скопируйте файл бота `main.py` в эту папку.

### Шаг 3: Создание виртуального окружения и установка зависимостей
```
python3.9 -m venv venv
source venv/bin/activate
pip install aiogram==3.0.0 pandas matplotlib
```

### Шаг 4: Изменение токена в файле
1. Откройте файл main.py в текстовом редакторе:
```
nano main.py
```
2. Найдите строку: `API_TOKEN = 'ВАШ_ТОКЕН_API'`
3. Замените 'ВАШ_ТОКЕН_API' на токен, полученный от BotFather (не удаляя кавычки)
4. Сохраните файл, нажав `Ctrl+O`, затем `Enter`, затем `Ctrl+X`

### Шаг 5: Запуск бота
```
python3 main.py
```

### Шаг 6: Настройка автозапуска (опционально)
Чтобы бот продолжал работать после закрытия терминала, вы можете использовать `screen`:

1. Установите screen:
```
sudo apt install screen
```

2. Создайте новую сессию screen:
```
screen -S telegrambot
```

3. Активируйте виртуальное окружение и запустите бота:
```
cd ~/telegrambot
source venv/bin/activate
python3 main.py
```

4. Нажмите `Ctrl+A`, затем `D`, чтобы отсоединиться от сессии (бот продолжит работать)

5. Чтобы вернуться к сессии с ботом:
```
screen -r telegrambot
```

## Использование бота

После запуска бота вы можете взаимодействовать с ним в Telegram, используя следующие команды:

- `/start` - Начало работы, выводит приветственное сообщение и основные команды
- `/report` - Создание отчета (о продажах или активности пользователей)
- `/stats` - Просмотр статистики за выбранный период

При первом запуске бот автоматически создаст базу данных SQLite и заполнит ее тестовыми данными для демонстрации.

## Возможные проблемы и их решение

### Windows: "Python не является внутренней или внешней командой..."
- Переустановите Python, обязательно установив флажок "Add Python to PATH"

### Linux: "Command python3 not found"
- Попробуйте использовать команду `python3.9` вместо `python3`

### Ошибка установки библиотек
- Попробуйте обновить pip перед установкой: `pip install --upgrade pip`
- Если проблема с matplotlib, установите системные зависимости (для Linux):
  ```
  sudo apt-get install python3-dev libfreetype6-dev
  ```

### Ошибка при запуске бота
- Убедитесь, что верно указан токен API в файле `main.py`
- Проверьте подключение к интернету
- Убедитесь, что все библиотеки установлены правильно

## Дополнительная информация

Этот бот использует:
- aiogram 3.0.0 - для взаимодействия с API Telegram
- pandas - для анализа данных
- matplotlib - для построения графиков
- SQLite - для хранения данных

Для более подробной информации о структуре и работе бота посмотрите комментарии в коде.